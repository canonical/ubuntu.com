<section class="p-strip--suru-topped">
  <div class="row">
    <div class="col-8">
      <h1>{{h1}}</h1>
      <p class="p-heading--4">{{intro_text}}</p>
    </div>
  </div>
  <div class="row">
    <div class="col-8">
      <form action="/marketo/submit" onsubmit="getCustomFields()" method="post" id="mktoForm_{{formid}}">
        <fieldset class="u-no-margin--bottom">
          <h3>About you</h3>
          <ul class="p-list">
            <li  class="p-list__item">
              <label for="FirstName" id="LblFirstName">First name:</label>
              {% if user_info and  "fullname" in user_info %}
              <input id="FirstName" name="firstName" maxlength="255" aria-labelledby="LblFirstName" type="text" class="is-required" required="" aria-required="true" value="{{user_info['fullname'].split(' ')[0]}}">
              {% else %}
              <input id="FirstName" name="firstName" maxlength="255" aria-labelledby="LblFirstName" type="text" class="is-required" required="" aria-required="true" >
              {% endif %}
            </li>

            <li  class="p-list__item">
              <label for="LastName" id="LblLastName">Last name:</label>
              {% if user_info and "fullname" in user_info %}
              <input id="LastName" name="lastName" maxlength="255" aria-labelledby="LblLastName InstructLastName" type="text" class="is-required" required="" aria-required="true" value="{{user_info['fullname'].split(' ')[-1]}}">
              {% else %}
              <input id="LastName" name="lastName" maxlength="255" aria-labelledby="LblLastName InstructLastName" type="text" class="is-required" required="" aria-required="true" >
              {% endif %}
            </li>

            <li  class="p-list__item">
              {% if user_info and "email" in user_info %}
              <input id="Email" name="email" maxlength="255" aria-labelledby="LblEmail InstructEmail" type="email" pattern="^[^ ]+@[^ ]+\.[a-z]{2,26}$" class="is-required" aria-required="true" autocomplete="email" value="{{user_info['email']}}">
              {% else %}
              <label for="Email" id="LblEmail">Work email*:</label>
              <input id="Email" name="email" maxlength="255" aria-labelledby="LblEmail InstructEmail" type="email" pattern="^[^ ]+@[^ ]+\.[a-z]{2,26}$" class="is-required" aria-required="true" autocomplete="email">
              <p>*Please note that Credentials are optimised for Ubuntu One accounts. If you already have an Ubuntu One account, please <a href="/login?next=/credentials/sign-up">log in</a>.
              {% endif %}
            </li>
            
            <li class="p-list__item ">
              <label for="NativeLanguage" id="LblNativeLanguage">What is your native language?</label>
              <select id="NativeLanguage" name="" aria-labelledby="LblNativeLanguage" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Arabic">  Arabic</option>
                <option value="Bengali">Bengali</option>
                <option value="Bhojpuri">Bhojpuri</option>
                <option value="Bulgarian">Bulgarian</option>
                <option value="Catalan">Catalan</option>
                <option value="Chinese">Chinese</option>
                <option value="Croatian">Croatian</option>
                <option value="Czech">Czech</option>
                <option value="Danish">Danish</option>
                <option value="Dutch">Dutch</option>
                <option value="English">English</option>
                <option value="Estonian">Estonian</option>
                <option value="Finnish">Finnish</option>
                <option value="French">French</option>
                <option value="German">German</option>
                <option value="Greek">Greek</option>
                <option value="Gujrati">Gujrati</option>
                <option value="Hausa">Hausa</option>
                <option value="Hebrew">Hebrew</option>
                <option value="Hindi/Urdu">Hindi/Urdu</option>
                <option value="Hungarian">Hungarian</option>
                <option value="Indonesian">Indonesian</option>
                <option value="Italian">Italian</option>
                <option value="Japanese">Japanese</option>
                <option value="Javanese">Javanese</option>
                <option value="Korean">Korean</option>
                <option value="Lithuanian">Lithuanian</option>
                <option value="Mandarin Chinese">Mandarin Chinese</option>
                <option value="Marathi">Marathi</option>
                <option value="Nigerian Pidgin">Nigerian Pidgin</option>
                <option value="Norwegian">Norwegian</option>
                <option value="Persian">Persian</option>
                <option value="Polish">Polish</option>
                <option value="Portuguese">Portuguese</option>
                <option value="Punjabi">Punjabi</option>
                <option value="Romanian">Romanian</option>
                <option value="Russian">Russian</option>
                <option value="Serbian">Serbian</option>
                <option value="Slovak">Slovak</option>
                <option value="Slovenian">Slovenian</option>
                <option value="Spanish">Spanish</option>
                <option value="Swedish">Swedish</option>
                <option value="Tamil">Tamil</option>
                <option value="Telugu">Telugu</option>
                <option value="Thai">Thai</option>
                <option value="Turkish">Turkish</option>
                <option value="Ukrainian">Ukrainian</option>
                <option value="Vietnamese">Vietnamese</option>
                <option value="Other">Other</option>
              </select>
            </li>

            <li class="p-list__item ">
              <label for="EmploymentLevel" id="LblEmploymentLevel">What is your Employment level?</label>
              <select id="EmploymentLevel" name="Job_Role__c" aria-labelledby="LblEmploymentLevel" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Entry-level">Entry-level</option>
                <option value="Mid-level">Mid-level</option>
                <option value="Senior">Senior</option>
                <option value="Management">Management</option>
                <option value="Senior Management">Senior Management</option>
                <option value="C-suite">C-suite</option>
              </select>
            </li>

            <li class="p-list__item ">
              <label for="JobTitle" id="LblTitle">Choose the closest category corresponding to your current occupation:</label>
              <select id="JobTitle" name="title" aria-labelledby="LblTitle" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Software">Software</option>
                <option value="DevOps">DevOps</option>
                <option value="SRE">SRE</option>
                <option value="Infrastructure and System admin">Infrastructure &amp; System admin</option>
                <option value="Architect">Architect</option>
                <option value="Networks and Security">Networks &amp; Security</option>
                <option value="Other">Other</option>
              </select>
            </li>

            <li class="p-list__item ">
              <label for="CUEMotivation" id="LblCUEMotivation" >What is your motivation to certify your Linux and Ubuntu skills?</label>
              <select id="CUEMotivation" name="" aria-labelledby="LblCUEMotivation" class="is-required" required="">
                  <option value="" disabled="disabled" selected="">Select...</option>
                  <option value="Personal growth">Personal growth</option>
                  <option value="Career change">Career change</option>
                  <option value="Employer requirement">Employer requirement</option>
                  <option value="Professional development">Professional development</option>
                  <option value="Educational interest">Educational interest</option>
                  <option value="Other">Other</option>
              </select>
            </li>
          </ul>
        </fieldset>

        <fieldset class="u-no-margin--bottom">
          <ul class="p-list">
            <h3>Knowledge</h3>
            <li class="p-list__item ">
              <label for="TrainingExperience" id="LblTrainingExperience">Have you received any training with Linux/Ubuntu?</label>
              <fieldset id="TrainingExperience" name="" aria-labelledby="LblTrainingExperience">
                <div class="row">
                  <div class="col-4">
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Bootcamp" aria-labelledby="Bootcamp" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="Bootcamp">Bootcamp</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Formal Education" aria-labelledby="FormalEducation" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="FormalEducation">Formal Education (university or similar)</span>
                    </label>
                  </div>
                  <div class="col-4">
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Professional Training" aria-labelledby="ProfessionalTraining" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="ProfessionalTraining">Professional Training</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Self Teaching" aria-labelledby="SelfTeaching" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="SelfTeaching">Self Teaching</span>
                    </label>
                  </div>
                </div>
              </fieldset>
            </li>

            <li  class="p-list__item ">
              <label for="UbuntuLastAcademicExperience" id="LblUbuntuLastAcademicExperience">When was the last time you had academic or training experience with Linux/Ubuntu?</label>
              <select id="UbuntuLastAcademicExperience" name="" aria-labelledby="LblUbuntuLastAcademicExperience" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Never">Never</option>
                <option value="Within the last year">Within the last year</option>
                <option value="1-3 years ago">1-3 years ago</option>
                <option value="4-7 years ago">4-7 years ago</option>
                <option value="8-10 years ago">8-10 years ago</option>
                <option value="10 years ago or more">10 years ago or more</option>
              </select>
            </li>

            <li  class="p-list__item ">
              <label for="UbuntuOverallExperience" id="LblUbuntuOverallExperience">How long have you used/worked with Ubuntu?</label>
              <select id="UbuntuOverallExperience" name="" aria-labelledby="LblUbuntuOverallExperience" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Never">Never</option>
                <option value="1-3 years">1-3 years</option>
                <option value="4-7 years">4-7 years</option>
                <option value="8-10 years">8-10 years</option>
                <option value="10 years or more">10 years or more</option>
              </select>
            </li>

            <li  class="p-list__item ">
              <label for="UbuntuLastProfessionalExperience" id="LblUbuntuLastProfessionalExperience">When was the last time you had professional experience with Ubuntu?</label>
              <select id="UbuntuLastProfessionalExperience" name="" aria-labelledby="LblUbuntuLastProfessionalExperience" class="is-required" required="">
                <option value="" disabled="disabled" selected="">Select...</option>
                <option value="Never">Never</option>
                <option value="Within the last month">Within the last month</option>
                <option value="Within the last three months">Within the last three months</option>
                <option value="Within the last year">Within the last year</option>
                <option value="1-3 years ago">1-3 years ago</option>
                <option value="4-7 years ago">4-7 years ago</option>
                <option value="8-10 years ago">8-10 years ago</option>
                <option value="10 years ago or more">10 years ago or more</option>
              </select>
            </li>
          </ul>
        </fieldset>

        <fieldset class="u-no-margin--bottom">
          <h3>Benchmark</h3>
          <ul class="p-list">
            <li class="p-list__item">
              <label for="OtherCertifications" id="LblOtherCertifications" >Do you hold any certifications from the following entities?</label>
              <fieldset id="OtherCertifications" name="" aria-labelledby="LblOtherCertifications" >
                <div class="row">
                  <div class="col-4">
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Linux Professional Institute" aria-labelledby="LinuxProfessionalInstitute" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="LinuxProfessionalInstitute">Linux Professional Institute</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="SUSE" aria-labelledby="SUSE" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="SUSE">SUSE</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="CompTIA" aria-labelledby="CompTIA" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="CompTIA">CompTIA</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="No Certifications" aria-labelledby="NoCertifications" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NoCertifications">I don't hold any certifications</span>
                    </label>
                  </div>
                  <div class="col-4">
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Red Hat" aria-labelledby="RedHat" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="RedHat">Red Hat</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Linux Foundation" aria-labelledby="LinuxFoundation" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="LinuxFoundation">Linux Foundation</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Other Certification" aria-labelledby="OtherCertifications" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="OtherCertification">Other</span>
                    </label>
                  </div>
                </div>
              </fieldset>
            </li>

            <li class="p-list__item">
              <label for="WhyOtherCertifications" id="LblWhyOtherCertifications" >If yes, why?</label>
              <fieldset id="WhyOtherCertifications" name="" aria-labelledby="LblWhyOtherCertifications" >
                <div class="row">
                  <div class="col-12">
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Job Differentiation" aria-labelledby="JobDifferentiation" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="JobDifferentiation">I think they are useful to differentiate myself when looking for a job</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Job Requirement" aria-labelledby="JobRequirement" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="JobRequirement">They are required to find a job or get a promotion in my industry</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Study Requirement" aria-labelledby="StudyRequirement" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="StudyRequirement">I had to pass them in the context of my training/studies</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Industry Standard" aria-labelledby="IndustryStandard" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="IndustryStandard">I wanted to know whether I was in line with industry standards</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Provided by Work" aria-labelledby="WorkProvided" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="WorkProvided">They were gifted to me/provided by my work</span>
                    </label>
                  </div>
                </div>
              </fieldset>
            </li>

            <li class="p-list__item">
              <label for="WhyNotOtherCertifications" id="LblWhyNotOtherCertifications" >If not, why?</label>
              <fieldset id="WhyNotOtherCertifications" name="" aria-labelledby="LblWhyNotOtherCertifications" >
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Too Expensive" aria-labelledby="TooExpensive" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="TooExpensive">I think they are too expensive</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Too Difficult" aria-labelledby="TooDifficult" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="TooDifficult">I find them too difficult</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="No corresponding certification" aria-labelledby="NoCorrespondingCertification" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NoCorrespondingCertification">I couldn't find a certification corresponding to what I wanted to test</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Not important in my industry" aria-labelledby="NotImportant" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NotImportant">I think they are not representative of what is important in my industry</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Not reputable" aria-labelledby="NotReputable" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NotReputable">My industry does not find these certifications reputable enough</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Not needed to prove skills" aria-labelledby="NotNeededForSkill" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NotNeededForSkill">I do not think that you need certifications to prove your skills</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Never needed to pass any" aria-labelledby="NeverNeeded" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NeverNeeded">I never needed to pass any of these certifications</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Did not have the opportunity" aria-labelledby="NoOpportunity" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="NoOpportunity">I did not have the opportunity to pass any of them yet</span>
                    </label>
                    <label class="p-checkbox">
                      <input class="p-checkbox__input" value="Other" aria-labelledby="OtherReasonForNoCert" name="" type="checkbox" />
                      <span class="p-checkbox__label" id="OtherReasonForNoCert">Other</span>
                    </label>
              </fieldset>
            </li>
          </ul>
          {# These are honey pot fields to catch bots #}
            <li class="u-off-screen">
              <label class="website" for="website">Website:</label>
              <input name="website" type="text" class="website" autocomplete="off" value="" id="website" tabindex="-1" />
            </li>
            <li class="u-off-screen">
              <label class="name" for="name">Name:</label>
              <input name="name" type="text" class="name" autocomplete="off" value="" id="name" tabindex="-1" />
            </li>
            {# End of honey pots #}
          <ul class="p-list">
            <li class="p-list__item">
              <label class="p-checkbox">
                <input class="p-checkbox__input" value="yes" aria-labelledby="canonicalUpdatesOptIn" name="canonicalUpdatesOptIn" type="checkbox">
                <span class="p-checkbox__label" id="canonicalUpdatesOptIn">I agree to receive information about Canonical's products and services.</span>
              </label>
            </li>
            <li class="p-list__item">
              In submitting this form, I confirm that I have read and agree to <a href="/legal/data-privacy/contact">Canonical's Privacy Notice</a> and <a href="/legal/data-privacy">Privacy Policy</a>.
            </li>
            <li class=" p-list__item">
              <button type="submit" class="p-button--positive" onclick="dataLayer.push({'event' : 'GAEvent', 'eventCategory' : 'Form', 'eventAction' : 'cloud contact-us', 'eventLabel' : '{{product}}', 'eventValue' : undefined });">Submit</button>
            </li>
          </ul>
          <!-- hidden fields -->
          <div class="u-hide">
            <label for="Comments_from_lead__c">Custom fields</label>
            <textarea id="Comments_from_lead__c" name="Comments_from_lead__c" rows="1" maxlength="2000"></textarea>
          </div>
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="formid"  value="{{formid}}" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="returnURL" value="{{returnURL}}" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="Consent_to_Processing__c" value="yes" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="utm_campaign"  id="utm_campaign" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="utm_medium"  id="utm_medium" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="utm_source"  id="utm_source" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="utm_content"  id="utm_content" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="utm_term"  id="utm_term" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="GCLID__c"  id="GCLID__c" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="Facebook_Click_ID__c"  id="Facebook_Click_ID__c" value="" />
          <input type="hidden" aria-hidden="true" aria-label="hidden field" name="Encode_Comments_from_lead__c"  id="Encode_Comments_from_lead__c" value="no" />
        </fieldset>
      </form>
    </div>
  </div>
</section>
<script>
  var isWebkit =
  /Chrome/i.test(navigator.userAgent) || /Safari/i.test(navigator.userAgent);
  var PROGRESS_COLOUR = '#E95420';
  var EMPTY_COLOUR = '#F4AA90';

  function renderSlider(slider) {
  if (isWebkit) {
    var value = (slider.value - slider.min) / (slider.max - slider.min);
    slider.style.backgroundImage = (
      '-webkit-gradient(linear, left top, right top, color-stop('
      + value + ', ' + PROGRESS_COLOUR + '), color-stop('
      + value + ', ' + EMPTY_COLOUR + '))'
    );
  }
}

function equaliseValues(receive, give) {
  receive.value = give.value;
  give.value = receive.value;
}

/**
  Attaches change listener to sliders to update their background color.
  @param {HTMLElement} slider Slider element to render background on.
*/
function initSlider(slider) {
  var input = document.getElementById(slider.id + '-input');
  renderSlider(slider);

  if (input) {
    // Synchronise values of input and slider
    equaliseValues(input, slider);
    input.addEventListener('input', function() {
      if (!input.value) {
        input.value = 0;
      }
      equaliseValues(slider, input);
      renderSlider(slider);
    });
  }

  slider.addEventListener('input', function() {
    if (input) {
      equaliseValues(input, slider);
    }
    renderSlider(slider);
  });
}

// Setup all sliders on the page.
var sliders = document.querySelectorAll('input[type=range]');

for (var i = 0, l = sliders.length; i < l; i++) {
  initSlider(sliders[i]);
}

function getCustomFields() {
  const nativeLanguage = document.getElementById("NativeLanguage");
  const cueMotivation = document.getElementById("CUEMotivation");
  const jobTitle = document.getElementById("JobTitle");

  // Training checkboxes
  const trainingExperiencesFieldset = document.getElementById("TrainingExperience");
  const trainingExperiences = getCheckboxItemsAsJson(trainingExperiencesFieldset);

  const ubuntuAcademicExperience = document.getElementById("UbuntuLastAcademicExperience");
  const ubuntuExperience = document.getElementById("UbuntuOverallExperience");
  const ubuntuProfessionalExperience = document.getElementById("UbuntuLastProfessionalExperience");

  // Other certifications
  const otherCertificationsFieldset = document.getElementById("OtherCertifications")
  const otherCertifications = getCheckboxItemsAsJson(otherCertificationsFieldset)

  // Why other certifications
  const whyOtherCertificationsFieldset = document.getElementById("WhyOtherCertifications")
  const whyOtherCertifications = getCheckboxItemsAsJson(whyOtherCertificationsFieldset)

  // Why not other certifications
  const whyNotOtherCertificationsFieldset = document.getElementById("WhyNotOtherCertifications")
  const whyNotOtherCertifications = getCheckboxItemsAsJson(whyNotOtherCertificationsFieldset)
  
  const data = {
      [nativeLanguage.id]: nativeLanguage.value,
      [cueMotivation.id]: cueMotivation.value,
      [jobTitle.id]: jobTitle.value,
      trainingExperiences,
      [ubuntuAcademicExperience.id]: ubuntuAcademicExperience.value,
      [ubuntuExperience.id]: ubuntuExperience.value,
      [ubuntuProfessionalExperience.id]: ubuntuProfessionalExperience.value,
      otherCertifications,
      whyOtherCertifications,
      whyNotOtherCertifications
    }

  const textarea = document.getElementById("Comments_from_lead__c");
  textarea.value = JSON.stringify(data);
  console.log(textarea.value);
}

function getCheckboxItemsAsJson(fieldset) {
  const checkboxes = fieldset.querySelectorAll("input[class='p-checkbox__input']");
  const items = {};
  checkboxes.forEach(item => {
      items[item.value] = item.checked;
  });

  return items;
}
</script>
