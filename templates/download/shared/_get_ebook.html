<div class="row row--ebook no-border">
    <div class="strip-inner-wrapper">
        <h2>Before you start, you&rsquo;ll want this eBook</h2>
        <div class="six-col append-one">
            <p class="not-for-small"><img src="{{ ASSET_SERVER_URL }}8697cae9-openstack-made-easy-illustration.svg" height="335" alt="" class="not-for-small"></p>
            <p>The phase change from traditional, monolithic software to multi-host microservices-based big software demands that you approach the challenge of deployment, integration and operations from a different perspective.</p>
            <p>This eBook will give you a deeper understanding into why there is a perceived complexity to the installation and operations of OpenStack and how tools like Canonical&rsquo;s OpenStack Autopilot can help you build a modern, scalable, repeatable and affordable private cloud infrastructure.</p>
        </div>
        <div class="five-col last-col">

            <!-- MARKETO FORM -->
            <script src="{{ ASSET_SERVER_URL }}37b1db88-jquery.min.js"></script>
            <script  src="{{ ASSET_SERVER_URL }}d55f58bb-jquery.validate.js"></script>
            <script src="{{ ASSET_SERVER_URL }}6ce35d3e-jquery-ui.min.js"></script>‌​

            <form action="https://pages.ubuntu.com/index.php/leadCapture/save" method="post" id="mktoForm_1460">
                <fieldset style="margin-top: -1.7em">
                    <ul class="no-bullets">

                        <li  class="mktFormReq mktField">
                            <label for="FirstName" class="mktoLabel " >First name:</label>
                            <input required  id="FirstName" name="FirstName" maxlength="255" type="text" class="mktoField   mktoRequired" >
                        </li>

                        <li  class="mktFormReq mktField">
                            <label for="LastName" class="mktoLabel " >Last name:</label>
                            <input required  id="LastName" name="LastName" maxlength="255" type="text" class="mktoField   mktoRequired" >
                        </li>

                        <li  class="mktFormReq mktField">
                            <label for="Company" class="mktoLabel " >Company name:</label>
                            <input required  id="Company" name="Company" maxlength="255" type="text" class="mktoField   mktoRequired" >
                        </li>

                        <li  class="mktFormReq mktField">
                            <label for="Email" class="mktoLabel " >Email address:</label>
                            <input required  id="Email" name="Email" maxlength="255" type="email" class="mktoField mktoEmailField  mktoRequired" >
                        </li>

                        <li  class="mktFormReq mktField">
                            <label for="Phone" class="mktoLabel " >Phone number:</label>
                            <input required  id="Phone" name="Phone" maxlength="255" type="tel" class="mktoField mktoTelField  mktoRequired" >
                        </li>

                        <li  class="mktField">
                            <input class="mktoField" value="yes" id="NewsletterOpt-In" name="NewsletterOpt-In" type="checkbox">
                            <label  class="mktoLabel mktoHasWidth" for="NewsletterOpt-In">I would like to receive occasional news from Canonical by email.</label>
                        </li>

                        <li  class="mktField">
                            <button type="submit" class="mktoButton" onsubmit="backgroundSubmitHandler();">Download the eBook</button><input type="hidden" name="formid" class="mktoField " value="1460"><input type="hidden" name="formVid" class="mktoField " value="1460"><input type="hidden" name="lpId" class="mktoField " value="2707"><input type="hidden" name="subId" class="mktoField " value="30"><input type="hidden" name="munchkinId" class="mktoField " value="066-EOV-335"><input type="hidden" name="lpurl" class="mktoField " value="//pages.ubuntu.com/Form---autopilot-cloud-ebook_autopilot-cloud-ebook-landing-page.html?cr={creative}&amp;kw={keyword}"><input type="hidden" name="cr" class="mktoField " value=""><input type="hidden" name="kw" class="mktoField " value=""><input type="hidden" name="q" class="mktoField " value="">
                        </li>
                        <li>All information provided will be handled in accordance with the Canonical <a href="/legal">privacy policy</a>.</li>
                    </ul>
                </fieldset>

                <input type="hidden" name="returnURL" value="http://www.ubuntu.com/download/cloud#instructions" />
                <input type="hidden" name="retURL" value="http://www.ubuntu.com/download/cloud#instructions" />
            </form>
            <!-- /MARKETO FORM -->

        </div>
    </div>
</div>
<!-- dependencies -->
<script src="{{ ASSET_SERVER_URL }}ec520d10-XMLHttpRequest.min.js"></script>
<script src="{{ ASSET_SERVER_URL }}4176b39e-serialize.js"></script>
<script src="{{ ASSET_SERVER_URL }}6b7597df-event-listener-polyfill.js"></script>
<!-- script -->
<script>
$("#mktoForm_1460").validate({
    errorElement: "span",
    errorClass: "mktFormMsg mktError",
    onkeyup: false,
    onclick: false,
    onblur: false
});

/**
* Given a form element, extract its data and its "action" target URL
* and submit the form using Ajax
*/
backgroundSubmit = function (formElement, submitCallback) {
    var request = new XMLHttpRequest();
    var submitUrl = formElement.getAttribute('action');
    var formData = serialize(formElement)

    request.open("POST", submitUrl, true);

    //Send the proper header information along with the request
    request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    // When request has finished, call the callback function
    if (submitCallback) {
        request.addEventListener(
            'readystatechange',
            function() {
                if (this.readyState == 4) {
                    // Pass context and arguments on to submitCallback
                    submitCallback.apply(this, arguments);
                }
            }
        );
    }

    // Send off the POST request
    request.send(formData);
}

/**
* After submit has happened
* start download and send the user to the instructions page
*/
afterSubmit = function() {
    // Now start the download
    downloadFrame = document.createElement("iframe");
    downloadFrame.setAttribute("src", "{{ ASSET_SERVER_URL }}f1bfc377-ebook_OpenStack_Made_Easy_20160726.pdf.zip");
    downloadFrame.style.width = 0+"px";
    downloadFrame.style.height = 0+"px";
    document.body.insertBefore(downloadFrame, document.body.childNodes[0]);
    // And redirect to the instructions page
    window.setTimeout(
        function () {window.location.href = "/{{ url|default:'download/cloud'}}#instructions";},
        1000
    );
}

/**
* Handler for a form submit event
* to disable the normal submit, and instead use backgroundSubmit
*/

backgroundSubmitHandler = function (submitEvent) {
    // Prevent normal submit
    submitEvent.preventDefault ? submitEvent.preventDefault() : submitEvent.returnValue = false;
    // Check form is valid
    if ($(marketoForm).valid()) {
        // Change the submit location
        marketoForm.action = "https://app-sjg.marketo.com/index.php/leadCapture/save2"
        // Submit the form in the background
        backgroundSubmit(marketoForm, afterSubmit);
    }
}

// Get the form
marketoForm = document.getElementById('mktoForm_1460');

// Attach the submit handler to the form
marketoForm.addEventListener('submit', backgroundSubmitHandler)
</script>
