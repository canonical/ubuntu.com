{% extends "security/cve/base_cve.html" %}

{% block body_class %}is-paper{% endblock body_class %}
{% block title %}
  {% if query or package or component or priority or versions or statuses %}
    CVE search results
  {% else %}
    CVEs
  {% endif %}
{% endblock %}

{% block content %}

<section class="p-strip is-shallow u-no-padding--bottom">
  <div class="row p-section">
    <div class="col-start-large-4 col-9">
      {% if query or package or component or priority or versions or statuses %}
        <h1>CVE reports</h1>
      {% else %}
        <h1>CVE reports</h1>
        <p>The Common Vulnerabilities and Exposures (CVE) system is used to identify, define, and catalog publicly disclosed cybersecurity vulnerabilities. Canonical keeps track of all CVEs affecting Ubuntu, and releases a <a href="/security/notices">security notice</a> when an issue is fixed.</p>
        <ul class="p-inline-list">
          <li class="p-inline-list__item"><a>Learn more about CVEs</a></li>
          <li class="p-inline-list__item"><a>OVAL data</a></li>
          <li class="p-inline-list__item"><a>Security API</a></li>
        </ul>
      {% endif %}
    </div>
  </div>
</section>

<section class="p-section">
  <div class="row--25-75">
    <hr class="p-rule"/>
    <div class="col">
      {% if query or package or component or priority or versions or statuses %}
        <!-- has to be this way because query string can exist with empty values -->
      {% else %}
        <h2>Search CVEs</h2>
      {% endif %}
    </div>
    <div class="col">
      <form id="searchForm">
        <div class="row">
          <div class="col-7">
            <label for="q">CVE ID or description contains:</label>
            <input  type="text" name="q" id="q" value="{{ query or '' }}">
          </div>
          <div class="col-2">
            <button style="margin-top: 2.6rem; width: 100%;" type="submit" class="p-button--positive" id="cve-search-button">
              <span class="cve-search-text">Search</span>
              <span class="cve-search-valid-cve-text u-hide">Go to CVE</span>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>

<section class="p-section">
  <div class="row">
    <div class="col-start-large-4 col-9">
      <hr class="p-rule"/>
      <div class="row">
        <div class="col-2">
          <h3 class="p-heading--5">By Ubuntu release</h3>
        </div>
        <div class="col-7">
          <ul class="p-inline-list" style="margin-top: .3rem;">
            <li class="p-inline-list__item"><a>All maintained releases</a></li>
            <li class="p-inline-list__item"><a>All LTS</a></li>
            <li class="p-inline-list__item"><a>22.04 LTS</a></li>
            <li class="p-inline-list__item"><a>20.04 LTS</a></li>
            <li class="p-inline-list__item"><a>18.04 LTS</a></li>
            <li class="p-inline-list__item"><a>23.10</a></li>
            <li class="p-inline-list__item"><a>Other releases</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="p-section">
  <div class="row">
    <hr class="p-rule"/>
    <div class="col-3 p-section--shallow">
      <h2>Recent CVEs</h2>
    </div>
    <div class="col-9 col-medium-6 p-section--shallow">
      {% for cve in high_priority_cves %}
      <div class="row">
        <div class="col-6 col-medium-4">
          <div style="margin-bottom: 1.1rem;">
            <p>
              <a class="p-heading--5" href="/security/{{ cve.id }}">{{ cve.id }}</a>
              <span style="float: inline-end;">
                {% if cve.priority == 'unknown' %}
                  <i class="p-icon--placeholder"></i>
                {% elif cve.priority == 'negligible' %}
                  <i class="p-icon--negligible-priority"></i>
                {% elif cve.priority == 'low' %}
                  <i class="p-icon--low-priority"></i>
                {% elif cve.priority == 'medium' %}
                  <i class="p-icon--medium-priority"></i>
                {% elif cve.priority == 'high' %}
                  <i class="p-icon--high-priority"></i>
                {% elif cve.priority == 'critical' %}
                  <i class="p-icon--critical-priority"></i>
                {% else %}
                  <i class="p-icon--placeholder"></i>
                {% endif %}
                <span>{{ cve.priority.split() | first | capitalize }} priority</span>
              </span>
            </p>
          </div>
        </div>
        <div class="col-3 col-medium-2">
          {% set status = cve.summarized_status %}
            {% if status.name == "Some fixed" %}
              <p>Some fixes available <span class="u-text--muted">{{ status.fixed_count }} of {{ status.total_count }}</span></p>
            {% elif status.name == "Needs evaluation" %}
              <p>
                <i class="p-icon--help"></i> <span>Needs evaluation</span>
              </p>
            {% endif %}
          </p>
        </div>
      </div>
      <div class="row p-section--shallow">
        <div class="col-6 col-medium-4">
          <p>{{ cve.description }}</p>
        </div>
        <div class="col-3 col-medium-2">
          <p class="p-text--small-caps u-text--muted u-no-margin--top">{{ cve.packages | length}} affected packages</p>
          <p class="u-text--muted">
            {% for package in cve.packages %}
              {% if cve.packages | length > 6 %}
                {% if loop.index < 6  %}
                  {{ package.name }}, 
                {% elif loop.index == 6 %}
                  and {{ cve.packages | length - 5 }} more
                {% endif %}
              {% elif cve.packages | length < 6 %}
                {% if loop.last %}
                  {{ package.name }}
                {% else %}
                  {{ package.name }},
                {% endif %}
              {% endif %}
            {% endfor %}
        </div>
      </div>
        {% if loop.index < 5 %}
          <hr class="p-rule"/>
        {% endif %}
      {% endfor %}
    </div>
  </div>

</section>

<section class="p-strip is-shallow u-overflow-inherit u-hide">
  <div class="u-fixed-width">
    {% if query or package or priority %}
    <h2>
      {% if total_results > 1 %}
        {{ offset + 1 }}
        &ndash;
        {% if offset + limit > total_results %}
          {{ total_results }}
        {% else %}
          {{ offset + limit }}
        {% endif %}
        of
      {% endif %}
      {{ total_results }} result{% if total_results != 1 %}s{% endif %}
    </h2>
    {% else %}
    <h2>Recent CVEs affecting Ubuntu</h2>
    {% endif %}
  </div>

  {% if total_results > 0 %}
  <div class="u-fixed-width">
    {% with cves=cves, releases=releases %}
    {% include "security/cve/_cve-table.html" %}
    {% endwith %}

    {% with %}
    {% include "security/cve/_pagination.html" %}
    {% endwith %}
  </div>
  {% endif %}
</section>

<template id="version-field-row-template">
  {% with versions=versions, statuses=statuses, releases=releases %}
  {% include "security/cve/_version-and-status-row.html" %}
  {% endwith %}
</template>

<section class="p-section">
  <div class="row--25-75 is-split-on-medium">
    <hr class="p-rule"/>
    <div class="col">
      <h2>Resources</h2>
    </div>
    <div class="col">
      <div class="row">
        <div class="col-3">
          <h3 class="p-heading--5">Join the discussion</h3>
        </div>
        <div class="col-6">
          <ul class="p-list--divided">
            <li class="p-list__item"><a href="https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened" onclick="dataLayer.push({'event' : 'GAEvent', 'eventCategory' : 'Contextual footer link', 'eventAction' : 'Ubuntu security updates mailing list', 'eventLabel' : 'Join the discussion', 'eventValue' : undefined });">Ubuntu security mailing list</a></li>
            <li class="p-list__item"><a href="https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce" onclick="dataLayer.push({'event' : 'GAEvent', 'eventCategory' : 'Contextual footer link', 'eventAction' : 'Security announcements mailing list', 'eventLabel' : 'Join the discussion', 'eventValue' : undefined });">Security announcements mailing list</a></li>
          </ul>
        </div>
      </div>
      <hr class="p-rule"/>
      <div class="row p-section--shallow">
        <div class="col-3">
          <h3 class="p-heading--5">Ubuntu Pro</h3>
        </div>
        <div class="col-6">
          <p>10-year security coverage for Ubuntu <br aria-hidden="true"> and 23,000 open-source applications and toolchains.</p>
          <a class="p-button" href="/pro">Get Ubuntu Pro</a>
        </div>
      </div>
      <hr class="p-rule"/>
      <div class="row">
        <div class="col-3">
          <h3 class="p-heading--5">From our blog</h3>
        </div>
        <div class="col-6">
          <ul class="p-list--divided">
            <li class="p-list__item"><a href="/blog/securing-multiple-ubuntu-instances-while-maximising-uptime">Ubuntu Explained: How to ensure security and stability in cloud instances—part 3</a></li>
            <li class="p-list__item"><a href="/blog/ubuntu-updates-best-practices-for-updating-your-instance">Ubuntu Explained: How to ensure security and stability in cloud instances—part 2</a></li>
            <li class="p-list__item"><a href="/blog/running-openssl-1-1-1-after-eol-with-ubuntu-pro">Running OpenSSL 1.1.1 after EOL? Stay secure with Ubuntu Pro.</a></li>
            <li class="p-list__item"><a href="/blog/ubuntu-23-10-restricted-unprivileged-user-namespaces">Restricted unprivileged user namespaces are coming to Ubuntu 23.10</a></li>
            <li class="p-list__item"><a href="/blog/securing-open-source-software-dependencies-in-the-public-cloud">Securing open source software dependencies in the public cloud</a></li>

          </ul>
        </div>
    </div>
  </div>
</section>

<script src="{{ versioned_static('js/dist/cve.js') }}" defer></script>

{% endblock %}
