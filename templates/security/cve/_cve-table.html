<table class="cve-table">
  <thead>
    <tr>
      <th style="width: 12em">CVE</th>
      <th>Package</th>
      {% for release in releases %}
        <th>
          <div class="icon-container__icon">
            <i class="p-icon--placeholder"></i>
          </div>
          <div class="icon-container__text">
            {{ release.version }} {{ release.support_tag }}
          </div>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for cve in cves %}
      {% for package_name, statuses in cve.status_tree.items() %}
        <tr>
          {% if loop.index == 1 %}
            <td rowspan="{{ cve.status_tree | length }}"><a href="/security/{{ cve.id }}">{{ cve.id }}</a></td>
          {% endif %}
          <td>{{ package_name }}</td>
          {% for release in releases %}
            {% if release.codename in statuses %}
              {% if statuses[release.codename].status == "DNE" or statuses[release.codename].status == "not-affected" %}
                <td class="cve-table-cell--muted">
              {% else %}
                <td class="cve-table-cell">
              {% endif %}
              {% if statuses[release.codename].status == "DNE" %}
                <div class="cve-color-strip--dne"></div>
              {% elif statuses[release.codename].status == "needs-triage" %}
                <div class="cve-color-strip--needs-triage"></div>
              {% elif statuses[release.codename].status == "not-affected" %}
                <div class="cve-color-strip--not-affected"></div>
              {% elif statuses[release.codename].status == "needed" %}
                <div class="cve-color-strip--needed"></div>
              {% elif statuses[release.codename].status == "deferred" %}
                <div class="cve-color-strip--deferred"></div>
              {% elif statuses[release.codename].status == "ignored" %}
                <div class="cve-color-strip--ignored"></div>
              {% elif statuses[release.codename].status == "pending" %}
                <div class="cve-color-strip--pending"></div>
              {% elif statuses[release.codename].status == "released" %}
                <div class="cve-color-strip--released"></div>
              {% endif %}
              <div class="icon-container__icon">
                {% if statuses[release.codename].status == 'DNE' or statuses[release.codename].status == 'not-affected' %}
                  <i class="p-icon--placeholder"></i>
                {% else %}
                  {% if cve.priority == 'unknown' %}
                    <i class="p-icon--placeholder"></i>
                  {% elif cve.priority == 'negligible' %}
                    <i class="p-icon--negligible-priority"></i>
                  {% elif cve.priority == 'low' %}
                    <i class="p-icon--low-priority"></i>
                  {% elif cve.priority == 'medium' %}
                    <i class="p-icon--medium-priority"></i>
                  {% elif cve.priority == 'high' %}
                    <i class="p-icon--high-priority"></i>
                  {% elif cve.priority == 'critical' %}
                    <i class="p-icon--critical-priority"></i>
                  {% else %}
                    <i class="p-icon--placeholder"></i>
                  {% endif %}
                {% endif %}
              </div>
              <div class="icon-container__text">
                {% if statuses[release.codename].status == "DNE" %}
                  Does not exist
                {% elif statuses[release.codename].status == "needs-triage" %}
                  Needs triage
                {% elif statuses[release.codename].status == "not-affected" %}
                  Not vulnerable
                {% elif statuses[release.codename].status == "needed" %}
                  Needed
                {% elif statuses[release.codename].status == "deferred" %}
                  Deferred
                {% elif statuses[release.codename].status == "ignored" %}
                  Ignored
                {% elif statuses[release.codename].status == "pending" %}
                  Pending
                {% elif statuses[release.codename].status == "released" %}
                  Released
                {% else %}
                  &mdash;
                {% endif %}
                <br>
                <small>
                  {% if statuses[release.codename].component == "esm-infra" %}
                    <a href="/advantage" target="_blank">UA Infra, UA Desktop</a>
                  {% endif %}
                  {% if statuses[release.codename].component == "esm-apps" %}
                    <a href="/advantage" target="_blank">UA Apps, UA Desktop</a>
                  {% endif %}
                </small>
              </div>
            </td>
            {% else %}
              <td class="cve-table-cell--muted">
                <div class="cve-color-strip--dne"></div>
                <div class="u-align--center">
                  &mdash;
                </div>
              </td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>
