<table class="cve-table">
  <thead>
    <tr>
      <th style="width: 10em;">ID</th>
      <th>Priority</th>
      <th>Package</th>
      {% for release in releases %}
        <th>
          <div class="icon-container__text">
            {{ release.version }} {{ release.support_tag }}
          </div>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for cve in cves %}
      {% for package_name, statuses in cve.packages.items() %}
        <tr>
          {% if loop.index == 1 %}
            <td class="cve-table-cell-id" rowspan="{{ cve.packages | length }}">
              <a href="/security/{{ cve.id }}">{{ cve.id }}</a>
            </td>
            <td class="cve-table-cell-priority" rowspan="{{ cve.packages | length }}">
              <div class="icon-container__icon">
                {% if cve.priority == 'unknown' %}
                  <i class="p-icon--placeholder"></i>
                {% elif cve.priority == 'negligible' %}
                  <i class="p-icon--negligible-priority"></i>
                {% elif cve.priority == 'low' %}
                  <i class="p-icon--low-priority"></i>
                {% elif cve.priority == 'medium' %}
                  <i class="p-icon--medium-priority"></i>
                {% elif cve.priority == 'high' %}
                  <i class="p-icon--high-priority"></i>
                {% elif cve.priority == 'critical' %}
                  <i class="p-icon--critical-priority"></i>
                {% else %}
                  <i class="p-icon--placeholder"></i>
                {% endif %}
              </div>
              <div class="icon-container__text">
                <span class="capitalize">{{ cve.priority }}</span>
              </div>
              <div class="icon-container__icon icon-cve-info">
                <i class="p-icon--information cve-tooltip-icon cve-tooltip-icon-priority" data-priority="{{ cve.priority }}"></i>
              </div>
            </td>
          {% endif %}
          <td>{{ package_name }}</td>
          {% for release in releases %}
            {% if release.codename in statuses %}
              <td class="cve-table-cell status-{{ statuses[release.codename].status }}">
              {% if statuses[release.codename].status == "DNE" %}
                <div class="cve-color-strip--dne"></div>
              {% elif statuses[release.codename].status == "needs-triage" %}
                <div class="cve-color-strip--needs-triage"></div>
              {% elif statuses[release.codename].status == "not-affected" %}
                <div class="cve-color-strip--not-affected"></div>
              {% elif statuses[release.codename].status == "needed" %}
                <div class="cve-color-strip--needed"></div>
              {% elif statuses[release.codename].status == "deferred" %}
                <div class="cve-color-strip--deferred"></div>
              {% elif statuses[release.codename].status == "ignored" %}
                <div class="cve-color-strip--ignored"></div>
              {% elif statuses[release.codename].status == "pending" %}
                <div class="cve-color-strip--pending"></div>
              {% elif statuses[release.codename].status == "released" %}
                <div class="cve-color-strip--released"></div>
              {% endif %}
              <div class="icon-container__text">
                {% if statuses[release.codename].status == "DNE" %}
                  Does not exist
                {% elif statuses[release.codename].status == "needs-triage" %}
                  Needs triage
                {% elif statuses[release.codename].status == "not-affected" %}
                  Not vulnerable
                {% elif statuses[release.codename].status == "needed" %}
                  Needed
                {% elif statuses[release.codename].status == "deferred" %}
                  Deferred
                {% elif statuses[release.codename].status == "ignored" %}
                  Ignored
                {% elif statuses[release.codename].status == "pending" %}
                  Pending
                {% elif statuses[release.codename].status == "released" %}
                  Released
                {% else %}
                  &mdash;
                {% endif %}
                {% if statuses[release.codename].pocket != "esm-infra" and statuses[release.codename].pocket == "esm-apps" %}
                  <small class="cve-table-cell esm-info">
                    {% if statuses[release.codename].pocket == "esm-infra" %}
                      <a href="/advantage">UA Infra/Apps</a>
                    {% endif %}
                    {% if statuses[release.codename].pocket == "esm-apps" %}
                      <a href="/advantage">UA Apps</a>
                    {% endif %}
                  </small>
                {% endif %}
              </div>
              <div class="icon-container__icon icon-cve-info">
                {% if statuses[release.codename].status == 'pending' or statuses[release.codename].status == "not-affected" %}
                  <i class="p-icon--information cve-tooltip-icon cve-tooltip-status" data-status="{{ statuses[release.codename].status }}"></i>
                {% endif %}
              </div>
            </td>
            {% else %}
              <td class="cve-table-cell--muted">
                <div class="cve-color-strip--dne"></div>
                &mdash;
              </td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>
