{% extends "security/cve/base_cve.html" %}
{% block title %}{{ cve.id  }}{% endblock %}

{% block head_extra %}
{% if cve.status == 'rejected' or cve.status == 'not-for-us' %}
<meta name="robots" content="noindex">
{% endif %}
{% endblock %}

{% block content %}

<nav class="p-navigation--secondary">
  <div class="row">
    <div class="col-12 u-equal-height">
      <a class="p-navigation--secondary__banner u-hide--nav-threshold-down" href="/security">
        <h5 class="p-navigation--secondary__logo">
          Security
        </h5>
      </a>
      <ul class="breadcrumbs--secondary">
        <li class="breadcrumbs__item">
          <a class="breadcrumbs__link p-link--soft" href="/security">Overview</a>
        </li>
        <li class="breadcrumbs__item">
          <a class="breadcrumbs__link p-link--soft" href="/security/certifications">Certifications</a>
        </li>
        <li class="breadcrumbs__item">
          <a class="breadcrumbs__link p-link--soft" href="https://usn.ubuntu.com">Notices</a>
        </li>
        <li class="breadcrumbs__item">
          <a class="breadcrumbs__link p-link--active" href="/security/cve">CVEs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

{% if cve.status == 'rejected' or cve.status == 'not-for-us' %}
<section class="p-strip--light is-bordered--top">
  {% else %}
  <section class="p-strip">
    {% endif %}

    <div class="row">
      <div class="col-9">
        <h1>{{ cve.id }}</h1>

        {% if cve.public_date %}
        <p>Published: <strong>{{ cve.public_date.strftime("%d %B %Y") }}</strong></p>
        {% endif %}

        {% if cve.status == 'active' and cve.last_updated_date and cve.last_updated_date != cve.public_date %}
        <p>Last updated: <strong>{{ cve.last_updated_date.strftime("%d %B %Y") }}</strong></p>
        {% endif %}

        {% if cve.description %}
        <p>{{ cve.description }}</p>
        {% endif %}

        {% if cve.ubuntu_description %}
        <h2>From the Ubuntu security team</h2>
        <p>{{ cve.ubuntu_description }}</p>
        {% endif %}
      </div>

      <div class="col-3">
        {% if cve.status == 'active' and cve.priority %}
        <div class="cve-status-box u-no-margin--bottom">
          <div class="p-muted-heading">Priority</div>
          <div class="p-heading-icon--small">
            <div class="p-heading-icon__header">
              {% if cve.priority == 'unknown' %}
                <img src="https://assets.ubuntu.com/v1/e85d00c8-CVE-Priority-icon-Unknown.svg" alt="" class="p-heading-icon__img">
              {% endif %}

              {% if cve.priority == 'negligible' %}
                <img src="https://assets.ubuntu.com/v1/f6820eae-CVE-Priority-icon-Negligible.svg" alt="" class="p-heading-icon__img">
              {% endif %}

              {% if cve.priority == 'low' %}
                <img src="https://assets.ubuntu.com/v1/2c18ab71-CVE-Priority-icon-Low.svg" alt="" class="p-heading-icon__img">
              {% endif %}

              {% if cve.priority == 'medium' %}
                <img src="https://assets.ubuntu.com/v1/6d25e065-CVE-Priority-icon-Medium.svg" alt="" class="p-heading-icon__img">
              {% endif %}

              {% if cve.priority == 'high' %}
                <img src="https://assets.ubuntu.com/v1/a9a5dc21-CVE-Priority-icon-High.svg" alt="" class="p-heading-icon__img">
              {% endif %}

              {% if cve.priority == 'critical' %}
                <img src="https://assets.ubuntu.com/v1/428a85f3-CVE-Priority-icon-Critical.svg" alt="" class="p-heading-icon__img">
              {% endif %}
              <h4 class="p-heading-icon__title u-no-margin--bottom">
                {{ cve.priority | capitalize }}
              </h4>
            </div>
          </div>
        </div>
        <p>CVSS 3 base score: {{ cve.cvss }}</p>
        {% endif %}

        {% if cve.status == 'rejected' %}
        <div class="cve-status-box--highlight">
          <div class="p-heading--four u-no-margin--bottom">
            Rejected
          </div>
        </div>
        {% endif %}

        {% if cve.status == 'not-for-us' %}
        <div class="cve-status-box--highlight">
          <div class="p-heading--four u-no-margin--bottom">
            Not in Ubuntu
          </div>
        </div>
        {% endif %}
      </div>

    </div>

    {% if cve.status == 'active' %}
    <div class="u-fixed-width">
      <h2>Status</h2>
      <table>
        <thead>
          <tr>
            <th>Package</th>
            <th>Release</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for package in cve.packages %}
          <tr>
            <td rowspan="{{ package.package_statuses | length }}">{{ package.name }}</td>
            <td>{{ package.package_statuses[0].release.name }}</td>
            <td>{{ package.package_statuses[0].status }}</td>
          </tr>
            {% for n in range(package.package_statuses | length) %}
            {% if n > 0 %}
            <tr>
              <td>{{ package.package_statuses[n].release.name }}</td>
              <td>{{ package.package_statuses[n].status }}</td>
            </tr>
            {% endif %}
            {% endfor %}
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}

    <div class="u-fixed-width">
      {% if cve.status == 'active' and cve.notes %}
      <h2>Notes</h2>
      <p>{{ cve.notes }}</p>
      {% endif %}

      <h2>References</h2>
      {% if cve.references %}
      <ul>
        {% for reference in cve.references %}
        <li><a href="{{ reference.uri }}">{{ reference.uri }}</a></li>
        {% endfor %}
      </ul>
      {% else %}
      <ul>
        <li>
          <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name={{ cve.id }}">
            MITRE
          </a>
        </li>
      </ul>
      {% endif %}

    </div>
  </section>

  {% with first_item="_security_discussion", second_item="_security_esm",
third_item="_security_further_reading" %}{% include
"shared/contextual_footers/_contextual_footer.html" %}{% endwith %} {% endblock %}
