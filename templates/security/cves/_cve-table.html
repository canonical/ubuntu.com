{% set expand_table = cve.packages|length > 6 %}
<table class="cve-table"
       aria-label="Detailed view of CVE card"
       id="table--{{ cve.id }}">
  <thead>
    <tr>
      <th>Package</th>
      {% if versions|length == 0 %}
        <th>24.04 LTS</th>
        <th>23.10 LTS</th>
        <th>22.04 LTS</th>
        <th>20.04 LTS</th>
        <th>18.04 ESM</th>
      {% else %}
        {% for release in selected_releases %}<th>{{ release.version }} {{ release.support_tag }}</th>{% endfor %}
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for package in cve.packages %}
      {% set row_index = loop.index %}
      <tr class="{% if row_index > 6 %}expandable-row u-hide{% endif %}">
        <td class="{% if row_index == 6 and expand_table %}blurred-row cve-table-blur {% endif %}">{{ package.name }}</td>
        {% for release in selected_releases %}
          {% set status = package.release_statuses[release.codename] %}
          {% if status %}
            <td class="{% if row_index == 6 and expand_table %}blurred-row cve-table-blur {% endif %}{% if status.slug == "DNE" %}u-text--muted{% endif %}">
              <i class="p-icon--{{ status.icon }}"></i> {{ status.name }}
            </td>
          {% elif versions|length > 0 or (versions|length == 0 and loop.index0 < 5) %}
            <td class="{% if row_index == 6 and expand_table %}blurred-row cve-table-blur{% endif %}">&mdash;</td>
          {% endif %}
        {% endfor %}
      </tr>
    {% endfor %}
    <tr />
  </tbody>
</table>
{% if expand_table %}
  <a href=""
     id="show--{{ cve.id }}"
     class="cve-footer-link p-link--soft js-show-packages">Show all {{ cve.packages | length }} packages</a>
{% endif %}
<a href=""
   id="hide--{{ cve.id }}"
   class="cve-footer-link p-link--soft js-hide-packages u-hide">Show less packages</a>
