{% set expand_table = cve.packages|length > 6 %}
<table class="cve-table  u-cve-table-horizontal-scroll__table"
       aria-label="Detailed view of CVE card"
       id="table--{{ cve.id }}">
  <thead>
    <tr>
      <th>Package</th>
      {% for release in selected_releases %}<th class="cve-table-packages">{{ release.version }} {% if release.support_tag == "ESM" %} LTS {% else %} {{ release.support_tag }} {% endif %}</th>{% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for package in cve.packages %}
      {% set row_index = loop.index %}
      <tr class="{% if row_index > 6 %}expandable-row u-hide{% endif %}">
        <td class="p-text--small {% if row_index == 6 and expand_table %}blurred-row cve-table-blur {% endif %}">{{ package.name }}</td>
        {% for release in selected_releases %}
          {% set status = package.release_statuses[release.codename] %}
          {% if status %}
            <td class="p-text--small {% if row_index == 6 and expand_table %}blurred-row cve-table-blur {% endif %}{% if status.slug == "DNE" %}u-text--muted{% endif %}">
              <i class="p-icon--{{ status.icon }} {% if status.icon %} u-icon-bump {% endif %}" ></i> <span {% if status.icon == None %} class="u-status-bump" {% endif %}>{{ status.name }}</span>
            </td>
          {% elif versions|length > 0 or (versions|length == 0 and loop.index0 < 5) %}
            <td class="{% if row_index == 6 and expand_table %}blurred-row cve-table-blur{% endif %}"><span class="u-status-bump">&mdash;</span></td>
          {% endif %}
        {% endfor %}
      </tr>
    {% endfor %}
  </tbody>
</table>
{% if expand_table %}
  <a href=""
     id="show--{{ cve.id }}"
     class="cve-footer-link p-link--soft js-show-packages">Show all {{ cve.packages | length }} packages</a>
{% endif %}
<a href=""
   id="hide--{{ cve.id }}"
   class="cve-footer-link p-link--soft js-hide-packages u-hide">Show less packages</a>
