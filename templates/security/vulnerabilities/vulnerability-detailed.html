{% extends "security/base_security.html" %}

{% block title %}Vulnerability Knowledge Base | document.title{% endblock %}

{% block meta_description %}{{ document.sections[0].title }}{% endblock %}

{% block body_class %}
  is-paper
{% endblock body_class %}

{% block content %}

  {% set breadcrumbs = [{"name": "Vulnerability knowledge base", "href": "/security/vulnerabilities"}, {"name": "View all", "href": "/security/vulnerabilities/view-all"}, {"name": document.title}] %}
  {% include '/shared/_breadcrumbs.html' %}

  <div class="p-section--hero">
    <div class="row--25-75">
      <div class="col">
        <div class="p-section">
          <div class="p-section--shallow">
            <h1>{{ document.title }}</h1>
            <p class="p-heading--3 section-heading" id="description">{{ document.sections[0].title }}</p>
            <div class="row">
              <div class="col-2 col-medium-2 col-small-2">
                <p class="u-no-margin--bottom u-sv1">Published</p>
              </div>
              <div class="col-2 col-medium-2 col-small-2">
                <p class="u-no-margin--bottom u-sv1">{{ format_date(metadata.published) }}</p>
              </div>
            </div>
            <div class="row">
              <div class="col-2 col-medium-2 col-small-2">Updated</div>
              <div class="col-2 col-medium-2 col-small-2">{{ document.updated }}</div>
            </div>
          </div>
          <hr class="p-rule" />
        </div>
      </div>
    </div>
    <div class="row">
      {% if document.sections|length > 1 %}
        <button class="p-toggle--sticky js-drawer-toggle"
                aria-controls="drawer"
                href="#"
                aria-expanded="false">Open side navigation</button>
        <div class="col-3">
          <nav class="p-side-navigation--raw-html is-single-page js-dynamic-toc"
               id="drawer">
            <div class="p-side-navigation__overlay js-drawer-toggle"
                 aria-controls="drawer"></div>
            <div class="p-side-navigation__drawer"
                 aria-label="documentation side navigation">
              <div class="p-side-navigation__drawer-header">
                <button href="#"
                        class="p-side-navigation__toggle--in-drawer js-drawer-toggle"
                        aria-controls="drawer"
                        aria-expanded="false">Close side navigation</button>
              </div>
              <ul>
                {% for section in document.sections %}
                  <li class="p-side-navigation__item">
                    {% if loop.first %}
                      <a class="highlight-link is-active" href="#description">Description</a>
                    {% else %}
                      <a class="highlight-link" href="#{{ format_to_id(section.title) }}">{{ section.title }}</a>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            </div>
          </nav>
        </div>
      {% endif %}
      <div class="col-9">
        {% for section in document.sections %}
          <div class="p-section--shallow vulnerabilities-content">
            {% if not loop.first %}
              <hr class="p-rule" />
              <h2 class="p-heading--3 section-heading"
                  id="{{ format_to_id(section.title) }}">{{ section.title }}</h2>
            {% endif %}
            <div id="main-content" style="overflow-wrap: break-word;">{{ section.content | safe }}</div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
  <script src="{{ versioned_static('js/dist/dynamic-toc.js') }}" defer></script>
{% endblock content %}
