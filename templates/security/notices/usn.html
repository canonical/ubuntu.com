{% extends "security/base_security.html" %}

{% block title %}{{ notice.id }}: {{ notice.title }} | Ubuntu security notices{% endblock %}

{% block content %}
<section class="p-strip--suru-topped">
  <div class="u-fixed-width">
    <h1>{{ notice.id }}: {{ notice.title }}</h1>
    <p class="p-muted-heading">{{ notice.published }}</p>
    <p class="u-sv3">{{ notice.summary | safe }}</p>
  </div>
  <div class="row">
    <div class="col-8">
      <h2>Releases</h2>
      <ul class="p-inline-list">
        {% for release in notice.releases %}
          <li class="p-inline-list__item">
            <a href="/security/notices?release={{ release.codename }}" class="p-button--tag">Ubuntu {{ release.version }} {{ release.support_tag }}</a>
          </li>
        {% endfor %}
      </ul>

      {% if notice.package_descriptions %}
        <h2>Packages</h2>
        <ul class="p-list">
          {% for package_name, package_title in notice.package_descriptions.items() %}
            <li class="p-list__item"><a href="/security/cves?package={{ package_name }}">{{ package_name }}</a> - {{ package_title }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      <h2>Details</h2>
      <p>{{ notice.details|safe }}</p>

      <h2>Update instructions</h2>
      {% if notice.release_packages %}
      <p>The problem can be corrected by updating your system to the following package versions:</p>
      {% for version in notice.release_packages.__reversed__() %}
        <h5>Ubuntu {{ version }}</h5>
        <ul class="p-list">
          {% for package_name, package in notice.release_packages[version].items() %}
            <li class="p-list__item">
              {% if package.source_link %}
                <a href="{{package.source_link}}">{{ package.name }}</a>
              {% else %}
                {{ package.name }}
              {% endif %}
              -
              {% if package.version_link %}
                <a href="{{package.version_link}}">{{ package.version }}</a>
              {% else%}
                {{ package.version }}
              {% endif %}
              <div>
                <small>
                  {% if package.pocket == "esm-infra" %}
                    Available with <a href="/pro">Ubuntu Pro (Infra-only)</a>
                  {% endif %}
                  {% if package.pocket == "esm-apps" %}
                    Available with <a href="/pro">Ubuntu Pro</a>
                  {% endif %}
                </small>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% endfor %}
      {% endif %}
      <p>{{ notice.instructions|safe }}</p>
    
      {% if notice.cves or notice.references %}
        <h2>References</h2>
        <ul class="p-list">
          {% if notice.cves %}
            {% for cve in notice.cves %}
              <li class="p-list__item"><a href="/security/{{ cve.id }}">{{ cve.id }}</a></li>
            {% endfor %}
          {% endif %}
  
          {% if notice.references %}
            {% for reference in notice.references %}
              <li class="p-list__item"><a href="{{ reference }}">{{ reference }}</a></li>
            {% endfor %}
          {% endif %}
        </ul>
      {% endif %}
      {% if notice.related_notices|length > 0 %}
        <h2>Related notices</h2>
        <ul class="p-list">
          {% for notice in notice.related_notices %}
            <li class="p-list__item">
              <a href="/security/notices/{{ notice.id }}">{{ notice.id }}</a>: {{ notice.packages }}
            </li>
          {% endfor %}
        </ul>
      {% endif %}

    </div>
    <div class="col-4">
      <div class="p-card--highlighted">
        <h3 class="p-card__title">Reduce your security exposure</h3>
        <p>Ubuntu Pro provides ten-year security coverage to 23,000+packages in Main and Universe, and it is free for up to five machines.</p>
        <p class="p-card__content"><a href="/pro/beta">Step-by-step tutorial to acivate Ubuntu Pro</a></p>
        <p class="p-card__content"><a href="/pro">Learn more about Ubuntu Pro</a></p>
      </div>
    </div>
  </div>
</section>

{% with first_item="_security_discussion", second_item="_security_need", third_item="_security_further_reading" %}{% include "shared/contextual_footers/_contextual_footer.html" %}{% endwith %}

{% endblock %}
