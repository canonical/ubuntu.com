{% extends "security/base_security.html" %}

{% block title %}Compliance automation calculator{% endblock %}

{% block meta_description %}Calculate time savings with Ubuntu Security Guide (USG).{% endblock %}

{% block meta_copydoc %}
  https://docs.google.com/document/d/1-oMEJ7J30oMX3EYcJ0kGBhUCLEML_c_cr0d_2JCylGY/edit?tab=t.0
{% endblock meta_copydoc %}

{% from "_macros/vf_hero.jinja" import vf_hero %}
{% from "_macros/vf_tiered-list.jinja" import vf_tiered_list %}
{% from "_macros/vf_data-spotlight.jinja" import vf_data_spotlight %}
{% from "_macros/vf_divided-section.jinja" import vf_divided_section %}
{% from "_macros/vf_cta-section.jinja" import vf_cta_section %}

{% block body_class %}
  is-paper
{% endblock body_class %}

{% block content %}

  {% call(slot) vf_hero(
    title_text='Compliance automation calculator',
    subtitle_text='Calculate time savings with Ubuntu Security Guide (USG)',
    layout='50/50'
    ) -%}
    {%- if slot == 'description' -%}
      <p>
        Manual compliance is time consuming and prone to human error. Ubuntu Security Guide (USG) automates hardening and auditing for CIS Benchmarks and DISA-STIG profiles, containing hundreds of individual configuration rules that would otherwise require manual implementation, testing, and ongoing verification.
      </p>
    {%- endif -%}
    {%- if slot == 'cta' -%}
      <a href="/security/contact-us"
         class="p-button--positive js-invoke-modal"
         aria-controls="security-modal">Contact us</a>
      <a href="https://documentation.ubuntu.com/security/compliance/">Learn more about compliance automation</a>
    {%- endif -%}
  {% endcall -%}

  {%- call(slot) vf_tiered_list(is_description_full_width_on_desktop=false, is_list_full_width_on_tablet=true) -%}
    {%- if slot == 'title' -%}
      <h2>Your environment</h2>
    {%- endif -%}

    {%- if slot == 'description' -%}
      <p>
        This calculator uses industry standard metrics and real world data to estimate time savings based on your environment.
      </p>
    {%- endif -%}

    {%- if slot == 'list_item_title_1' -%}
      <h3 class="p-heading--5">Compliance profile complexity</h3>
    {%- endif -%}

    {%- if slot == 'list_item_description_1' -%}
      <p>Different profiles contain different numbers of rules and implementation complexity</p>

      <div class="p-slider__wrapper">
        <input type="range"
               min="1"
               max="3"
               value="1"
               step="1"
               id="compliance-profile"
               aria-label="CIS Level from 1 to 3" />
        <select class="p-slider__input p-slider__input--extended"
                name="exampleSelect"
                id="compliance-profile-input">
          <option value="1" selected="">CIS Level 1</option>
          <option value="2">CIS Level 2</option>
          <option value="3">DISA-STIG</option>
        </select>
      </div>

    {%- endif -%}

    {%- if slot == 'list_item_title_2' -%}
      <h3 class="p-heading--5">Number of Ubuntu systems requiring compliance</h3>
    {%- endif -%}

    {%- if slot == 'list_item_description_2' -%}
      <p>Servers and workstations that need CIS or DISA-STIG hardening</p>

      <div class="p-slider__wrapper">
        <input type="range"
               min="5"
               max="500"
               value="50"
               step="5"
               id="num-systems"
               aria-label="Number of Ubuntu systems requiring compliance, from 5 to 500" />
        <input class="p-slider__input p-slider__input--extended"
               type="text"
               maxlength="3"
               id="num-systems-input"
               tabindex="0"
               disabled
               style="opacity:1" />
      </div>
    {%- endif -%}

    {%- if slot == 'list_item_title_3' -%}
      <h3 class="p-heading--5">Compliance audits per year</h3>
    {%- endif -%}

    {%- if slot == 'list_item_description_3' -%}
      <p>How often you verify compliance (quarterly = 4, monthly = 12, etc.)</p>

      <div class="p-slider__wrapper">
        <input type="range"
               min="1"
               max="12"
               value="4"
               step="1"
               id="audit-frequency"
               aria-label="Compliance audits per year, from 1 to 12" />
        <input class="p-slider__input p-slider__input--extended"
               type="text"
               maxlength="3"
               id="audit-frequency-input"
               tabindex="0"
               disabled
               style="opacity:1" />
      </div>
    {%- endif -%}

    {%- if slot == 'list_item_title_4' -%}
      <h3 class="p-heading--5">Configuration drift checks per month</h3>
    {%- endif -%}

    {%- if slot == 'list_item_description_4' -%}
      <p>How often you check for configuration changes between audits</p>

      <div class="p-slider__wrapper">
        <input type="range"
               min="0"
               max="8"
               value="2"
               step="1"
               id="drift-checks"
               aria-label="Configuration drift checks per month, from 0 to 8" />
        <input class="p-slider__input p-slider__input--extended"
               type="text"
               maxlength="3"
               id="drift-checks-input"
               tabindex="0"
               disabled
               style="opacity:1" />
      </div>
    {%- endif -%}

    {%- if slot == 'list_item_title_5' -%}
      <h3 class="p-heading--5">New systems deployed per month</h3>
    {%- endif -%}

    {%- if slot == 'list_item_description_5' -%}
      <p>New servers/workstations requiring initial compliance hardening expected every month</p>

      <div class="p-slider__wrapper">
        <input type="range"
               min="0"
               max="50"
               value="3"
               step="1"
               id="new-systems"
               aria-label="New systems deployed per month, from 0 to 50" />
        <input class="p-slider__input p-slider__input--extended"
               type="text"
               maxlength="3"
               id="new-systems-input"
               tabindex="0"
               disabled
               style="opacity:1" />
      </div>
    {%- endif -%}
  {%- endcall -%}

  {{ vf_data_spotlight(title={
    "text": "Estimated annual time savings",
    },
    blocks=[
    {
    "stat": "<span id=\"total-time-savings\">0</span>",
    "headline": "hours per year",
    "description": "Estimated based on the parameters",
    },
    {
    "stat": "<span id=\"work-weeks\">0</span>",
    "headline": "work weeks",
    "description": "Or 0.63 Full time employee ",
    },
    {
    "stat": "<span id=\"cost-savings\">0</span>",
    "headline": "Cost savings",
    "description": "Approximately per year",
    }
    ],) }}

  <div class="p-section--shallow">
    <div class="grid-row">
      <div class="grid-col-4 grid-col-start-large-5">
        <div class="p-cta-block">
          <a href="/security/contact-us"
             class="p-button--positive js-invoke-modal"
             aria-controls="security-modal">Contact us</a>
        </div>
      </div>
    </div>
  </div>

  <section class="p-section">
    <hr class="p-rule--muted is-fixed-width" />
    <div class="grid-row">
      <div class="grid-col-4 grid-col-start-large-5">
        <div class="p-section--shallow">
          <h2 class="p-heading--4">Time savings breakdown</h2>
          <p class="p-heading--4">
            <strong><span id="total-breakdown">0</span></strong> <span class="u-text--muted">hrs total annual time savings</span>
          </p>
        </div>
        <table aria-label="Total savings breakdown table">
          <thead>
            <tr>
              <th>Task</th>
              <th>Hours of work</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>Initial system hardening automation</th>
              <td>
                <span id="hardening-time"></span>
              </td>
            </tr>
            <tr>
              <th>Compliance audit execution</th>
              <td>
                <span id="audit-time"></span>
              </td>
            </tr>
            <tr>
              <th>Configuration drift monitoring</th>
              <td>
                <span id="drift-time"></span>
              </td>
            </tr>
            <tr>
              <th>New system deployment hardening</th>
              <td>
                <span id="new-system-time"></span>
              </td>
            </tr>
            <tr>
              <th>Audit report generation</th>
              <td>
                <span id="documentation-time"></span>
              </td>
            </tr>
            <tr>
              <th>Remediation and fixing</th>
              <td>
                <span id="remediation-time"></span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  {# djlint:off #}
  {{ vf_divided_section(
    title={
      "text": "Detailed calculation methodology",
    },
    blocks=[
      {
        "type": "divided-block",
        "bullet_type": "number",
        "items": [
          {
            "title_text": "Initial System Hardening (One-time per existing system)",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-hardening\"></div>"
                }
              }
            ]
          },
          {
            "title_text": "Compliance Audit Execution (Per audit cycle)",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-audit\"></div>"
                }
              }
            ]
          },
          {
            "title_text": "Configuration Drift Monitoring (Ongoing checks)",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-drift\"></div>"
                }
              }
            ]
          },
          {
            "title_text": "New System Deployment (Monthly ongoing)",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-new-system\"></div>"
                }
              }
            ]
          },
          {
            "title_text": "Audit Report Generation (Per audit)",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-documentation\"></div>"
                }
              }
            ]
          },
          {
            "title_text": "Remediation After Audits (Per cycle, ~30% of systems)",
            "contents": [
              {
                "type": "description",
                "padding": "shallow",
                "item": {
                  "type": "text",
                  "content": "<div id=\"formula-remediation\"></div>"
                }
              }
            ]
          }
        ]
      },
      {
        "type": "divided-block",
        "bullet_type": "none",
        "items": [
          {
            "title_text": "Total annual savings",
            "contents": [
              {
                "type": "description",
                "item": {
                  "type": "text",
                  "content": 
                  "<div class=\"p-section--shallow\" id=\"formula-total\"></div>
                  <p>The numbers used in the calculations are .based on common industry metrics.</p>"
                }
              }
            ]
          }
        ]
      }
    ],
  )}}
  {# djlint:on #}

  {% call(slot) vf_cta_section(
    title_text='Ready to automate your compliance?',
    variant='block',
    layout='100'
    ) -%}
    {%- if slot == 'description' -%}
      <p>Ubuntu Pro includes USG for automated CIS and DISA-STIG compliance.</p>
    {%- endif -%}
    {%- if slot == 'cta' -%}
      <a href="/pro" class="p-button--positive">Get Ubuntu Pro</a>
      <a href="/security/security-standards" class="p-button">Learn about certifications</a>
    {%- endif -%}
  {% endcall -%}

  {{ load_form("/security") | safe }}

  <script src="{{ versioned_static('js/src/slider-base.js') }}"></script>
  <script>
    // Profile definitions based on actual benchmark specifications
    const profiles = {
      1: {
        name: 'CIS Level 1',
        rules: 200,
        manualHardeningHours: 4.0,
        description: '~200 rules, practical security'
      },
      2: {
        name: 'CIS Level 2',
        rules: 250,
        manualHardeningHours: 5.0,
        description: '~250 rules, defense in depth'
      },
      3: {
        name: 'DISA-STIG',
        rules: 300,
        manualHardeningHours: 6.5,
        description: '300+ rules, DoD requirements'
      }
    };
    // Constants based on industry research - all verified
    const USG_HARDENING_HOURS = 0.25; // 15 minutes per system
    const MANUAL_AUDIT_HOURS_PER_SYSTEM = 2.5; // Manual audit time
    const USG_AUDIT_HOURS_PER_SYSTEM = 0.17; // 10 minutes automated
    const MANUAL_REMEDIATION_HOURS = 1.5; // Per system per cycle
    const USG_REMEDIATION_HOURS = 0.25; // 15 minutes automated
    const MANUAL_REPORT_HOURS = 6.0; // Per audit cycle
    const USG_REPORT_HOURS = 0.5; // 30 minutes automated
    const MANUAL_DRIFT_CHECK_HOURS = 3.0; // Per check across environment
    const USG_DRIFT_CHECK_HOURS = 0.5; // 30 minutes automated
    const REMEDIATION_RATE = 0.30; // 30% of systems need fixes per audit (conservative)
    const AVG_ENGINEER_SALARY = 120000; // Annual salary for cost calculation
    const WORKING_HOURS_PER_YEAR = 2080; // Standard 40hrs/week * 52 weeks
    // Get all input elements
    const numSystems = document.getElementById("num-systems");
    const complianceProfile = document.getElementById("compliance-profile");
    const auditFrequency = document.getElementById("audit-frequency");
    const driftChecks = document.getElementById("drift-checks");
    const newSystems = document.getElementById("new-systems");
    // Get all display elements
    const numSystemsValue = document.getElementById("num-systems-input");
    const complianceProfileValue = document.getElementById("compliance-profile-input");
    const auditFrequencyValue = document.getElementById("audit-frequency-input");
    const driftChecksValue = document.getElementById("drift-checks-input");
    const newSystemsValue = document.getElementById("new-systems-input");
    // Calculate time savings
    function calculateTimeSavings() {
      const systems = parseInt(numSystems.value);
      const profile = profiles[complianceProfile.value];
      const auditsPerYear = parseInt(auditFrequency.value);
      const driftChecksPerMonth = parseInt(driftChecks.value);
      const newSystemsPerMonth = parseInt(newSystems.value);
      // 1. Initial Hardening Savings (existing systems - one time)
      const manualHardeningTotal = systems * profile.manualHardeningHours;
      const usgHardeningTotal = systems * USG_HARDENING_HOURS;
      const hardeningTimeSavings = manualHardeningTotal - usgHardeningTotal;
      // 2. Compliance Audit Execution Savings (repeated per audit frequency)
      const manualAuditTotal = systems * MANUAL_AUDIT_HOURS_PER_SYSTEM * auditsPerYear;
      const usgAuditTotal = systems * USG_AUDIT_HOURS_PER_SYSTEM * auditsPerYear;
      const auditTimeSavings = manualAuditTotal - usgAuditTotal;
      // 3. Configuration Drift Monitoring (ongoing)
      const driftChecksPerYear = driftChecksPerMonth * 12;
      const manualDriftTotal = MANUAL_DRIFT_CHECK_HOURS * driftChecksPerYear;
      const usgDriftTotal = USG_DRIFT_CHECK_HOURS * driftChecksPerYear;
      const driftTimeSavings = manualDriftTotal - usgDriftTotal;
      // 4. New System Deployment Hardening (monthly new systems)
      const newSystemsPerYear = newSystemsPerMonth * 12;
      const manualNewSystemTotal = newSystemsPerYear * profile.manualHardeningHours;
      const usgNewSystemTotal = newSystemsPerYear * USG_HARDENING_HOURS;
      const newSystemTimeSavings = manualNewSystemTotal - usgNewSystemTotal;
      // 5. Audit Report Generation (per audit)
      const manualReportTotal = MANUAL_REPORT_HOURS * auditsPerYear;
      const usgReportTotal = USG_REPORT_HOURS * auditsPerYear;
      const documentationTimeSavings = manualReportTotal - usgReportTotal;
      // 6. Remediation and Fixing (per audit cycle)
      const systemsNeedingRemediation = Math.floor(systems * REMEDIATION_RATE);
      const manualRemediationTotal = systemsNeedingRemediation * MANUAL_REMEDIATION_HOURS * auditsPerYear;
      const usgRemediationTotal = systemsNeedingRemediation * USG_REMEDIATION_HOURS * auditsPerYear;
      const remediationTimeSavings = manualRemediationTotal - usgRemediationTotal;
      // Total savings
      const totalSavings = Math.round(
        hardeningTimeSavings +
        auditTimeSavings +
        driftTimeSavings +
        newSystemTimeSavings +
        documentationTimeSavings +
        remediationTimeSavings
      );
      // Cost savings calculation
      const hourlyRate = AVG_ENGINEER_SALARY / WORKING_HOURS_PER_YEAR;
      const costSavings = Math.round(totalSavings * hourlyRate);
      const fte = (totalSavings / WORKING_HOURS_PER_YEAR).toFixed(2);
      // Update display
      document.getElementById("total-time-savings").textContent = totalSavings.toLocaleString();
      document.getElementById("work-weeks").textContent = Math.round(totalSavings / 40);
      document.getElementById("cost-savings").textContent = costSavings.toLocaleString();
      // Update breakdown
      document.getElementById("hardening-time").textContent = Math.round(hardeningTimeSavings).toLocaleString();
      document.getElementById("audit-time").textContent = Math.round(auditTimeSavings).toLocaleString();
      document.getElementById("drift-time").textContent = Math.round(driftTimeSavings).toLocaleString();
      document.getElementById("new-system-time").textContent = Math.round(newSystemTimeSavings).toLocaleString();
      document.getElementById("documentation-time").textContent = Math.round(documentationTimeSavings).toLocaleString();
      document.getElementById("remediation-time").textContent = Math.round(remediationTimeSavings).toLocaleString();
      document.getElementById("total-breakdown").textContent = totalSavings.toLocaleString();
      // Update formulas with actual numbers
      document.getElementById("formula-hardening").textContent =
        `${systems} systems x (${profile.manualHardeningHours} hrs manual - ${USG_HARDENING_HOURS} hrs USG) = ${Math.round(hardeningTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-audit").textContent =
        `${systems} systems x (${MANUAL_AUDIT_HOURS_PER_SYSTEM} hrs manual - ${USG_AUDIT_HOURS_PER_SYSTEM} hrs USG) x ${auditsPerYear} audits/year = ${Math.round(auditTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-drift").textContent =
        `(${MANUAL_DRIFT_CHECK_HOURS} hrs manual - ${USG_DRIFT_CHECK_HOURS} hrs USG) x ${driftChecksPerMonth} checks/month x 12 = ${Math.round(driftTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-new-system").textContent =
        `${newSystemsPerMonth} new systems/month x 12 x (${profile.manualHardeningHours} hrs manual - ${USG_HARDENING_HOURS} hrs USG) = ${Math.round(newSystemTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-documentation").textContent =
        `(${MANUAL_REPORT_HOURS} hrs manual - ${USG_REPORT_HOURS} hrs USG) x ${auditsPerYear} audits = ${Math.round(documentationTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-remediation").textContent =
        `${systemsNeedingRemediation} systems (~30% needing fixes) x (${MANUAL_REMEDIATION_HOURS} hrs manual - ${USG_REMEDIATION_HOURS} hrs USG) x ${auditsPerYear} audits = ${Math.round(remediationTimeSavings).toLocaleString()} hours saved`;
      document.getElementById("formula-total").textContent =
        `${Math.round(hardeningTimeSavings).toLocaleString()} + ${Math.round(auditTimeSavings).toLocaleString()} + ${Math.round(driftTimeSavings).toLocaleString()} + ${Math.round(newSystemTimeSavings).toLocaleString()} + ${Math.round(documentationTimeSavings).toLocaleString()} + ${Math.round(remediationTimeSavings).toLocaleString()} = ${totalSavings.toLocaleString()} hours/year (${fte} FTE)`;
    }
    // Event listeners for all inputs
    numSystems.addEventListener("input", () => {
      calculateTimeSavings();
    });
    complianceProfile.addEventListener("input", () => {
      calculateTimeSavings();
    });
    auditFrequency.addEventListener("input", () => {
      calculateTimeSavings();
    });
    driftChecks.addEventListener("input", () => {
      calculateTimeSavings();
    });
    newSystems.addEventListener("input", () => {
      calculateTimeSavings();
    });
    numSystemsValue.addEventListener("input", () => {
      calculateTimeSavings();
    });
    complianceProfileValue.addEventListener("change", () => {
      calculateTimeSavings();
    });
    auditFrequencyValue.addEventListener("input", () => {
      calculateTimeSavings();
    });
    driftChecksValue.addEventListener("input", () => {
      calculateTimeSavings();
    });
    newSystemsValue.addEventListener("input", () => {
      calculateTimeSavings();
    });
    // Initialize on page load
    updateDisplayValues();
    calculateTimeSavings();
  </script>
{% endblock content %}
